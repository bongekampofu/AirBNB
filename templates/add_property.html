<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Add Property</title>

    <!-- BOOTSTRAP -->
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">

</head>
<body class="bg-light">

<div class="container mt-5">
    <h2 class="mb-4">Add Property</h2>

    <!--flash messages -->
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class="alert alert-{{ category }} alert-dismissible fade show">
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            {% endfor %}
        {% endif %}
    {% endwith %}

    <form method="POST" enctype="multipart/form-data" class="card shadow p-4 bg-white">
        {{ form.hidden_tag() }}

        <div class="mb-3">
            {{ form.title.label(class="form-label") }}
            {{ form.title(class="form-control") }}
        </div>

        <div class="mb-3">
            {{ form.description.label(class="form-label") }}
            {{ form.description(class="form-control") }}
        </div>

        <div class="mb-3">
            {{ form.location.label(class="form-label") }}
            {{ form.location(class="form-control") }}
        </div>

        <div class="mb-3">
            {{ form.price_per_night.label(class="form-label") }}
            {{ form.price_per_night(class="form-control", id="priceInput") }}
        </div>

        <div class="mb-3">
            {{ form.image.label(class="form-label") }}
            {{ form.image(class="form-control", id="imageInput") }}
        </div>

        <!--image preview -->
        <div class="mt-3">
            <img id="preview" src="https://via.placeholder.com/200x150?text=Preview"
                 class="img-thumbnail" width="200">
        </div>

        <div class="mt-4">
            {{ form.submit(class="btn btn-primary") }}
        </div>

    </form>
</div>

<!--javascript event driven -->
<script>

    // Prevent negative prices
    document.getElementById('priceInput').addEventListener('input', function(event) {
        const price = parseFloat(event.target.value);
        if (price < 0) {
            alert('Price cannot be negative!');
            event.target.value = 0;
        }
    });

    // Image preview
    document.getElementById('imageInput').addEventListener('change', function(event) {
        const file = event.target.files[0];
        const preview = document.getElementById('preview');

        if (file) {
            preview.src = URL.createObjectURL(file);
        } else {
            preview.src = "https://via.placeholder.com/200x150?text=Preview";
        }
    });

</script>

</body>
</html>
